tests:
  - name: "Verify nologin log processing"
    inputs:
      - insert_at: "parse_nologin"
        type: "log"
        log_fields:
          message: "Feb 20 10:42:06 mihir-ubuntu nologin: Attempted login by test (UID: 1001) on /dev/pts/1"

    outputs:
      - extract_from: "parse_nologin"
        conditions:
          - type: "vrl"
            source: |
              # Verify that the transform correctly extracts fields and does not modify the message.
              assert!(exists(.timestamp), "timestamp missing")
              assert_eq!(.timestamp, "Feb 20 10:42:06", "unexpected timestamp value")
              assert!(exists(.hostname), "hostname missing")
              assert_eq!(.hostname, "mihir-ubuntu", "unexpected hostname value")
              assert!(exists(.program), "program missing")
              assert_eq!(.program, "nologin", "unexpected program value")
              assert!(exists(.appname), "appname missing")
              assert_eq!(.appname, "nologin", "unexpected appname value")
              assert!(exists(.username), "username missing")
              assert_eq!(.username, "test", "unexpected username value")
              assert!(exists(.user_uid), "user_uid missing")
              assert_eq!(.user_uid, 1001, "unexpected user_uid value")
              assert!(exists(.tty), "tty missing")
              assert_eq!(.tty, "/dev/pts/1", "unexpected tty value")
       
