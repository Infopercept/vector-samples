tests:
  - name: "Verify systemd-logind new session parsing"
    inputs:
      - insert_at: "parse_systemd_logind"
        type: "log"
        log_fields:
          message: "Feb 20 10:41:42 mihir-ubuntu systemd-logind[1142]: New session 7 of user test."

    outputs:
      - extract_from: "parse_systemd_logind"
        conditions: 
          - type: "vrl"
            source: |
              # Ensure expected fields exist and have correct values
              assert!(exists(.timestamp), "timestamp missing")
              assert_eq!(.timestamp, "Feb 20 10:41:42", "unexpected timestamp value")
              assert!(exists(.hostname), "hostname missing")
              assert_eq!(.hostname, "mihir-ubuntu", "unexpected hostname value")
              assert!(exists(.program), "program missing")
              assert_eq!(.program, "systemd-logind", "unexpected program value")
              assert!(exists(.pid), "pid missing")
              assert_eq!(.pid, 1142, "unexpected pid value")
              assert!(exists(.appname), "appname missing")
              assert_eq!(.appname, "systemd-logind", "unexpected appname value")
              assert!(exists(.session_id), "session_id missing")
              assert_eq!(.session_id, 7, "unexpected session_id value")
              assert!(exists(.username), "username missing")
              assert_eq!(.username, "test.", "unexpected username value")
              assert!(exists(.event_type), "event_type missing")
              assert_eq!(.event_type, "new session", "unexpected event_type value")
              assert!(exists(.source_type), "source_type missing")
              assert_eq!(.source_type, "file", "unexpected source_type value")
              assert!(exists(.host), "host missing")
              assert_eq!(.host, "localhost.localdomain", "unexpected host value")
