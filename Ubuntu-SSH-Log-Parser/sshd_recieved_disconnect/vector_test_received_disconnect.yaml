tests:
  - name: "Verify received disconnect log processing"
    inputs:
      - insert_at: "parse_disconnect"
        type: "log"
        log_fields:
          message: "Feb 20 10:41:47 mihir-ubuntu sshd[3154]: Received disconnect from 192.168.186.1 port 62721:11: disconnected by user"

    outputs:
      - extract_from: "parse_disconnect"
        conditions:
          - type: "vrl"
            source: |
              assert_eq!(.timestamp, "Feb 20 10:41:47", "unexpected timestamp value")
              assert_eq!(.hostname, "mihir-ubuntu", "unexpected hostname value")
              assert_eq!(.program, "sshd", "unexpected program value")
              assert_eq!(.appname, "sshd", "unexpected appname value")
              assert_eq!(.pid, 3154, "unexpected pid value")
              assert_eq!(.disconnect_ip, "192.168.186.1", "unexpected disconnect_ip value")
              assert_eq!(.port, 62721, "unexpected port value")
              assert_eq!(.disconnect_code, 11, "unexpected disconnect_code value")
              assert_eq!(.reason, "disconnected by user", "unexpected reason value")
              assert_eq!(.event_type, "recieved disconnect by user", "unexpected event_type value")
